<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nulass Dinner Night & Award - Voting System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
            background: 
                radial-gradient(circle at 20% 80%, rgba(183, 65, 14, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(186, 97, 35, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.7;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
            position: relative;
        }

        /* Header Styles */
        .header {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 50px;
            align-items: center;
            margin-bottom: 60px;
            background: 
                linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,249,250,0.9) 100%),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="20" cy="20" r="1" fill="%23B7410E" opacity="0.1"/><circle cx="80" cy="80" r="1" fill="%23ba6123" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            border-radius: 30px 100px 30px 30px;
            padding: 50px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(183, 65, 14, 0.15);
            box-shadow: 
                0 20px 60px rgba(183, 65, 14, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(183, 65, 14, 0.1) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        .logo {
            width: 160px;
            height: 160px;
            object-fit: cover;
            border-radius: 25px;
            border: 4px solid #B7410E;
            box-shadow: 
                0 15px 35px rgba(183, 65, 14, 0.3),
                0 5px 15px rgba(0, 0, 0, 0.1);
            transform: rotate(-3deg);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .logo:hover {
            transform: rotate(0deg) scale(1.05);
            box-shadow: 
                0 25px 50px rgba(183, 65, 14, 0.4),
                0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .header-content {
            text-align: left;
            z-index: 2;
            position: relative;
        }

        .event-title {
            font-size: clamp(2.5rem, 5vw, 4rem);
            margin-bottom: 20px;
            background: linear-gradient(120deg, #B7410E 0%, #ba6123 50%, #B94700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 900;
            letter-spacing: -2px;
            line-height: 1.1;
            text-shadow: 0 2px 4px rgba(183, 65, 14, 0.1);
        }

        .event-slogan {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            color: #B7410E;
            margin-bottom: 25px;
            font-weight: 500;
            font-style: italic;
            opacity: 0.9;
        }

        .event-description {
            font-size: 1.1rem;
            opacity: 0.8;
            margin-bottom: 25px;
            max-width: 600px;
        }

        .host-info {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: linear-gradient(135deg, rgba(183, 65, 14, 0.15) 0%, rgba(186, 97, 35, 0.1) 100%);
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 600;
            border: 2px solid rgba(183, 65, 14, 0.2);
            backdrop-filter: blur(10px);
            box-shadow: 
                0 8px 25px rgba(183, 65, 14, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .host-info::before {
            content: 'üèÜ';
            font-size: 1.2rem;
        }

        /* Banner Styles */
        .banner-section {
            margin-bottom: clamp(20px, 5vw, 40px);
            overflow: hidden;
            border-radius: clamp(8px, 3vw, 15px);
            position: relative;
            width: 100%;
        }

        .banner-carousel {
            display: flex;
            gap: clamp(10px, 3vw, 20px);
            animation: autoScroll 15s linear infinite;
            width: calc(var(--banner-width) * 6);
            will-change: transform;
        }

        :root {
            --banner-width: clamp(250px, 60vw, 380px);
            --banner-height: clamp(140px, 35vw, 220px);
        }

        @keyframes autoScroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .banner-item {
            flex: 0 0 auto;
            width: var(--banner-width);
            position: relative;
        }

        .banner-item img {
            width: 100%;
            height: var(--banner-height);
            object-fit: cover;
            border-radius: clamp(8px, 2vw, 15px);
            border: clamp(1px, 0.5vw, 3px) solid rgba(183, 65, 14, 0.3);
            transition: all 0.3s ease;
            display: block;
        }

        /* Section Styles */
        .section {
            background: 
                linear-gradient(145deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 250, 0.9) 100%);
            border-radius: 25px;
            padding: 50px;
            margin-bottom: 40px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(183, 65, 14, 0.1);
            box-shadow: 
                0 15px 40px rgba(183, 65, 14, 0.08),
                0 5px 15px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #B7410E, #ba6123, #B94700);
            border-radius: 25px 25px 0 0;
        }

        .section h2 {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 35px;
            font-size: clamp(1.5rem, 4vw, 2.2rem);
            color: #B7410E;
            font-weight: 700;
            letter-spacing: -1px;
            position: relative;
        }

        .section h2::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(90deg, rgba(183, 65, 14, 0.3), transparent);
            margin-left: 20px;
        }




/* Category Card */
.category-card {
  flex: 1 1 300px;
  max-width: 350px;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.08);
  overflow: hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.category-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 10px 25px rgba(0,0,0,0.12);
}

.category-title {
  background: linear-gradient(135deg, #B7410E, #ba6123);
  color: #fff;
  font-size: 1.2rem;
  font-weight: 600;
  padding: 14px;
  text-align: center;
}

/* Nominee */
.nominee-item {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 12px 15px;
  margin: 10px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: background 0.3s ease;
}

.nominee-item:hover {
  background: #e9ecef;
}

.nominee-name {
  font-weight: 500;
}

.nominee-votes {
  background: #B7410E;
  color: white;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
}


/* Category Card */
.category-card {
  flex: 0 0 320px;
  display: flex;
  flex-direction: column;
  border-radius: 20px;
  overflow: hidden;
  scroll-snap-align: center;
  transition: all .3s ease;
  background: linear-gradient(145deg, #ffffff, #f9fafe);
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  cursor: pointer;
}
.category-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 12px 32px rgba(0,0,0,0.12);
}
.category-card.expanded {
  box-shadow: 0 16px 40px rgba(0,0,0,0.15);
}

/* Category Header */
.category-card .category-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 18px;
  background: linear-gradient(90deg, #005bea, #00c6fb);
  color: #fff;
  font-weight: 700;
  font-size: 1.05rem;
}
.category-card .toggle-icon {
  font-size: 1.2rem;
  font-weight: 900;
}

/* Nominees Container (slide down) */
.category-card .nominees-list {
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transition: max-height .45s cubic-bezier(.2,.9,.3,1), opacity .35s ease;
  padding: 0 14px;
  background: #fff;
}
.category-card .nominees-list.open {
  max-height: 600px;
  opacity: 1;
  padding: 16px;
}

/* Horizontal Row for Nominees */
.nominees-row {
  display: flex;
  gap: 16px;
  overflow-x: auto;
  padding-bottom: 8px;
}
.nominees-row::-webkit-scrollbar { display: none; }

/* Nominee Item */
.nominee-item {
  flex: 0 0 200px;
  background: #fff;
  border-radius: 14px;
  padding: 14px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  gap: 10px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.06);
  transition: all .25s ease;
}
.nominee-item:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 26px rgba(0,0,0,0.12);
}
.nominee-name {
  font-weight: 600;
  font-size: 1rem;
  color: #1f2937;
}
.nominee-votes {
  font-size: 0.85rem;
  background: linear-gradient(45deg,#ff6a00,#ee0979);
  color: #fff;
  padding: 6px 12px;
  border-radius: 20px;
  align-self: flex-start;
  font-weight: 500;
}

/* Highlighted Search Match */
.nominee-item.highlight {
  outline: 3px solid #fcd34d;
  box-shadow: 0 12px 28px rgba(251,191,36,0.3);
}


/* ---------------------------
   Category Scroll Arrows
   --------------------------- */
.cat-scroll-btn {
  position: fixed;
  top: 45%;
  z-index: 1200;
  width: 48px;
  height: 48px;
  border-radius: 12px;
  border: none;
  background: linear-gradient(45deg,#005bea,#00c6fb);
  color: white;
  font-size: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 8px 22px rgba(0,0,0,0.2);
  cursor: pointer;
}
#catLeftBtn { left: 16px; }
#catRightBtn { right: 16px; }
.cat-scroll-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 10px 28px rgba(0,0,0,0.25);
}
@media (max-width:900px) {
  .cat-scroll-btn { display:none; }
}

.search-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin: 20px auto;
  max-width: 800px;
  position: relative;
}

/* üîç Search Bar Container */
.search-bar-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 14px;
  padding: 6px 12px;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
  transition: all 0.2s ease;
  position: relative;
  width: 100%;
  max-width: 600px;
  margin: 10px auto;
}

.search-bar-container:focus-within {
  border-color: #B7410E;
  box-shadow: 0 4px 12px rgba(183, 65, 14, 0.2);
}

/* Input field */
#searchBar {
  flex: 1;
  border: none;
  outline: none;
  font-size: 1rem;
  padding: 10px;
  background: transparent;
  min-width: 0; /* Fix for small screens */
}

/* Icon buttons (voice & category) */
.icon-btn {
  background: #f8f9fa;
  border: none;
  padding: 8px 12px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 1.2rem;
  transition: background 0.2s ease, transform 0.2s ease;
}

.icon-btn:hover {
  background: #eee;
  transform: scale(1.05);
}

/* üìÇ Category Dropdown */
.category-dropdown {
  position: absolute;
  top: 110%;
  right: 10px;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 12px;
  box-shadow: 0 5px 12px rgba(0,0,0,0.1);
  padding: 10px;
  display: none;
  z-index: 100;
  width: 200px;
}

/* üîΩ Search Results */
.search-results {
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 12px;
  margin-top: 8px;
  padding: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.08);
  display: none;
  position: absolute;
  width: 100%;
  max-width: 600px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 90;
}

/* üìå Categories Grid */
.categories-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 12px;
  margin-top: 20px;
}

.categories-grid .card {
  background: #fff;
  border: 1px solid #eee;
  border-radius: 14px;
  padding: 15px;
  text-align: center;
  box-shadow: 0 3px 8px rgba(0,0,0,0.05);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.categories-grid .card:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 12px rgba(0,0,0,0.1);
}

/* üì± Mobile Responsiveness */
@media (max-width: 480px) {
  .search-bar-container {
    flex-wrap: nowrap;
    padding: 6px 8px;
  }

  #searchBar {
    font-size: 0.9rem;
  }

  .icon-btn {
    padding: 6px 10px;
    font-size: 1rem;
  }

  .category-dropdown {
    width: 160px;
  }
}


#categoryMenuBtn {
  padding: 10px 14px;
  border: none;
  border-radius: 10px;
  background: linear-gradient(45deg, #005bea, #00c6fb);
  color: white;
  cursor: pointer;
  font-size: 1.2rem;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  transition: background 0.3s;
}
#categoryMenuBtn:hover {
  background: linear-gradient(45deg, #00c6fb, #005bea);
}

#categoryDropdown {
  display: none;
  flex-direction: column;
  gap: 8px;
  position: absolute;
  top: 60px; /* below button */
  right: 0;
  background: white;
  border-radius: 10px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  padding: 10px;
  z-index: 1000;
}
#categoryDropdown button {
  background: #f5f7fa;
  border: none;
  border-radius: 8px;
  padding: 8px 12px;
  font-size: 0.95rem;
  cursor: pointer;
  text-align: left;
}
#categoryDropdown button:hover {
  background: #eaf0fb;
}

/* ---------------------------
   Scroll Down Button
   --------------------------- */
.scroll-down {
  position: fixed;
  bottom: 90px;
  right: 95px;
  width: 55px;
  height: 55px;
  background: linear-gradient(45deg, #28a745, #20c997);
  color: white;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1200;
  font-size: 22px;
  transition: all 0.3s ease;
  box-shadow: 0 6px 18px rgba(0,0,0,0.25);
}
.scroll-down:hover {
  background: linear-gradient(45deg, #20c997, #28a745);
  transform: translateY(-4px);
}
.scroll-down:active {
  transform: translateY(2px);
}

        /* Vote Modal Styles - Improved Responsive Design */
        .vote-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            overflow-y: auto;
        }

        .vote-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            padding: clamp(20px, 5vw, 40px);
            border-radius: clamp(15px, 3vw, 25px);
            text-align: center;
            width: clamp(300px, 90vw, 500px);
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            border: 3px solid #B7410E;
            box-shadow: 0 20px 60px rgba(183, 65, 14, 0.4);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: clamp(15px, 4vw, 30px);
            gap: 10px;
        }

        .modal-header h3 {
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            color: #B7410E;
            margin: 0;
            text-align: left;
            flex: 1;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: clamp(20px, 5vw, 24px);
            color: #B7410E;
            cursor: pointer;
            padding: 5px;
            flex-shrink: 0;
            border-radius: 50%;
            transition: all 0.3s ease;
            width: clamp(30px, 6vw, 40px);
            height: clamp(30px, 6vw, 40px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: rgba(183, 65, 14, 0.1);
            transform: scale(1.1);
        }

        .modal-nominee-info {
            background: rgba(183, 65, 14, 0.1);
            padding: clamp(15px, 4vw, 20px);
            border-radius: clamp(10px, 2vw, 15px);
            margin-bottom: clamp(15px, 4vw, 25px);
            border: 1px solid rgba(183, 65, 14, 0.2);
            text-align: left;
        }

        .modal-nominee-info h4 {
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            margin-bottom: 10px;
        }

        .modal-nominee-info p {
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            margin-bottom: 5px;
        }

        .form-group {
            margin-bottom: clamp(15px, 4vw, 25px);
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: clamp(5px, 2vw, 10px);
            font-weight: 600;
            color: #B7410E;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
        }

        .form-control {
            width: 100%;
            padding: clamp(12px, 4vw, 18px) clamp(15px, 4vw, 25px);
            border: 2px solid rgba(183, 65, 14, 0.2);
            border-radius: clamp(12px, 3vw, 16px) clamp(12px, 3vw, 16px) clamp(12px, 3vw, 16px) 4px;
            background: 
                linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 250, 0.9) 100%);
            color: #333;
            font-size: clamp(14px, 3vw, 16px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            box-shadow: 
                0 4px 15px rgba(183, 65, 14, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .form-control:focus {
            outline: none;
            border-color: #B7410E;
            box-shadow: 
                0 0 0 4px rgba(183, 65, 14, 0.15),
                0 8px 25px rgba(183, 65, 14, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.98);
            transform: translateY(-2px);
        }

        .vote-summary {
            background: rgba(40, 167, 69, 0.1);
            padding: clamp(15px, 4vw, 20px);
            border-radius: clamp(10px, 2vw, 15px);
            margin-bottom: clamp(15px, 4vw, 25px);
            border: 1px solid rgba(40, 167, 69, 0.2);
            text-align: left;
        }

        .vote-summary h4 {
            color: #28a745;
            margin-bottom: 10px;
            font-size: clamp(1rem, 3vw, 1.2rem);
        }

        .vote-summary p {
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            margin-bottom: 5px;
        }

        .vote-summary .price {
            font-size: clamp(1.4rem, 4vw, 1.8rem);
            font-weight: bold;
            color: #28a745;
        }

        .form-actions {
            display: flex;
            flex-wrap: wrap;
            gap: clamp(10px, 3vw, 15px);
            justify-content: center;
            margin-top: clamp(15px, 4vw, 25px);
        }

        /* Button Styles - Mobile Optimized */
        .btn {
            background: linear-gradient(135deg, #B7410E 0%, #ba6123 50%, #B94700 100%);
            color: white;
            border: none;
            padding: clamp(12px, 3vw, 16px) clamp(20px, 5vw, 32px);
            border-radius: clamp(15px, 3vw, 20px) clamp(15px, 3vw, 20px) clamp(15px, 3vw, 20px) 6px;
            font-size: clamp(13px, 3vw, 16px);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: clamp(8px, 2vw, 12px);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: 
                0 8px 25px rgba(183, 65, 14, 0.3),
                0 3px 10px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            min-width: clamp(100px, 25vw, 140px);
            text-align: center;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .btn:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                0 15px 40px rgba(183, 65, 14, 0.4),
                0 8px 20px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #495057);
        }

        .btn-success {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        /* Alert Styles */
        .alert {
            padding: 18px 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            font-weight: 500;
        }

        .alert i {
            margin-right: 12px;
            font-size: 18px;
        }

        .alert-success {
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.5);
            color: #28a745;
        }

        .alert-error {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.5);
            color: #dc3545;
        }

        .alert-info {
            background: rgba(23, 162, 184, 0.2);
            border: 1px solid rgba(23, 162, 184, 0.5);
            color: #17a2b8;
        }

        /* Loading Styles */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .loading-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #B7410E;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .event-title {
                font-size: 2.2rem;
            }

            .event-slogan {
                font-size: 1.4rem;
            }

            .categories-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .header {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 30px;
                padding: 30px 20px;
                border-radius: 20px;
            }

            .header-content {
                text-align: center;
            }

            .logo {
                width: 120px;
                height: 120px;
                margin: 0 auto 20px auto;
                transform: rotate(0deg);
            }

            .section {
                padding: 30px 20px;
                border-radius: 20px;
            }

            .vote-modal-content {
                border-radius: 20px;
                position: relative;
                top: auto;
                left: auto;
                transform: none;
                margin: 20px auto;
                max-height: calc(100vh - 40px);
            }

            .vote-modal {
                align-items: flex-start;
                padding: 20px 0;
            }
        }

        @media (max-width: 480px) {
            .nominee-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .section h2 {
                font-size: 1.4rem;
                flex-direction: column;
                gap: 10px;
            }

            .section h2::after {
                display: none;
            }

            .category-card {
                padding: 25px 20px;
                border-radius: 20px;
            }

            .nominee-item {
                padding: 18px;
                border-radius: 15px;
            }

            .form-actions {
                flex-direction: column;
                align-items: stretch;
            }

            .btn {
                width: 100%;
                margin: 0;
            }
        }

        /* Small Mobile Devices */
        @media (max-width: 375px) {
            .vote-modal-content {
                width: 95vw;
                margin: 10px auto;
                padding: 15px;
            }

            .form-control {
                padding: 12px 15px;
                font-size: 14px;
            }
        }
        
         /* Scroll Down Button */
        .scroll-down {
            position: fixed;
            bottom: 140px;
            right: 25px;
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: block;
            z-index: 1000;
            font-size: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .scroll-down:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }
        
        /* Font */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap');
body {
  font-family: 'Poppins', sans-serif;
}

/* Smooth fade-in animations */
.section, .category-card, .nominee-item {
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp 0.8s ease forwards;
}
.category-card:nth-child(1) { animation-delay: 0.2s; }
.category-card:nth-child(2) { animation-delay: 0.4s; }
.category-card:nth-child(3) { animation-delay: 0.6s; }

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Award Gold Gradient */
.gold-text {
  background: linear-gradient(45deg, #FFD700, #FF8C00);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 800;
}

/* Pulse effect for call-to-action */
.scroll-down {
  animation: pulse 1.5s infinite;
}
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); box-shadow: 0 0 15px rgba(40,167,69,0.6); }
  100% { transform: scale(1); }
}

/* Modal upgrade */
.vote-modal-content {
  animation: slideUp 0.4s ease;
}
@keyframes slideUp {
  from { transform: translate(-50%, 100%); opacity: 0; }
  to { transform: translate(-50%, -50%); opacity: 1; }
}
/* üìÇ Category Dropdown */
.category-dropdown {
  position: absolute;
  top: 110%;
  right: 10px;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 12px;
  box-shadow: 0 5px 12px rgba(0,0,0,0.1);
  padding: 10px;
  display: none;
  z-index: 100;
  width: 220px;
  max-height: 300px;   /* ‚úÖ Restrict height */
  overflow-y: auto;    /* ‚úÖ Enable vertical scrolling */
  scrollbar-width: thin;       /* Firefox */
  scrollbar-color: #bbb #f5f5f5;
}

/* Custom scrollbar for WebKit (Chrome, Safari, Edge) */
.category-dropdown::-webkit-scrollbar {
  width: 6px;
}

.category-dropdown::-webkit-scrollbar-track {
  background: #f5f5f5;
  border-radius: 10px;
}

.category-dropdown::-webkit-scrollbar-thumb {
  background: #bbb;
  border-radius: 10px;
}

.category-dropdown::-webkit-scrollbar-thumb:hover {
  background: #999;
}


.ticket-btn {
  background: #B7410E;
  color: white;
  padding: 12px 20px;
  border: none;
  border-radius: 10px;
  font-size: 1.1rem;
  cursor: pointer;
  transition: 0.2s;
}
.ticket-btn:hover {
  background: #a0390c;
}

    </style>
</head>

   <body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <img src="https://i.ibb.co/zWr7G0xB/IMG-20250819-WA0055-1.jpg" alt="Nulass Logo" class="logo">
                <h1 class="event-title">Nulass Awards</h1>
                
                <div class="host-info">
                    Committee Chairman: <strong>Bami</strong>
                </div>
                
            </div>
        </div>

        <!-- Banner Section -->
        <div class="banner-section">
            <div class="banner-carousel">
                <div class="banner-item">
                    <img src="https://i.ibb.co/5hrNmSgM/Fast-Withdrawal-s-20250806-044026-0000.png" alt="Event Banner 1" />
                </div>
                <div class="banner-item">
                    <img src="https://i.ibb.co/zWr7G0xB/IMG-20250819-WA0055-1.jpg" alt="Event Banner 2" />
                </div>
                <div class="banner-item">
                    <img src="https://i.ibb.co/tpNVMDrZ/Fast-Withdrawal-s-20250806-044937-0000.png" alt="Event Banner 3" />
                </div>
            </div>
        </div>

        <!-- Voting Section -->
        <div class="section">
            <h2><i class="fas fa-vote-yea"></i> Vote for Nominees</h2>
            <button id="getTicketBtn" class="ticket-btn">üéüÔ∏è Get Ticket</button>

            <div class="alert alert-info">
                <i class="fas fa-info-circle"></i> 
                Click on any nominee to cast your vote. Each vote costs ‚Ç¶50.
            </div>

        <!-- üîç Search Bar Container -->
<div class="search-bar-container">
  <input type="text" id="searchBar" placeholder="Search the name ..." />

  

  <!-- üìÇ Category Menu -->
  <button id="categoryMenuBtn" class="icon-btn" title="Categories">‚ò∞</button>

  <!-- Dropdown for Categories -->
  <div id="categoryDropdown" class="category-dropdown"></div>
</div>

<!-- üîΩ Dynamic Search Results -->
<div class="search-results" id="searchResults">
  <!-- Results appear here -->
</div>
 
<!-- üìå Category Grid -->
<div id="categoriesGrid" class="categories-grid"></div>


     

        <!-- Vote Modal -->
        <div id="voteModal" class="vote-modal">
            <div class="vote-modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-vote-yea"></i> Cast Your Vote</h3>
                    <button class="modal-close" onclick="closeVoteModal()">&times;</button>
                </div>

                <div class="modal-nominee-info" id="modalNomineeInfo">
                    <!-- Nominee info will be populated here -->
                </div>

                <div class="form-group">
                    <label for="voterName">Your Name</label>
                    <input type="text" id="voterName" class="form-control" placeholder="Enter your full name" required>
                </div>

                <div class="form-group">
                    <label for="voterEmail">Your Email</label>
                    <input type="email" id="voterEmail" class="form-control" placeholder="Enter your email address" required>
                </div>

                <div class="form-group">
                    <label for="voteCount">Number of Votes</label>
                    <input type="number" id="voteCount" class="form-control" min="1" value="1" placeholder="Enter number of votes" required>
                </div>

                <div class="vote-summary" id="voteSummary">
                    <h4><i class="fas fa-calculator"></i> Payment Summary</h4>
                    <p>Votes: <span id="summaryVotes">1</span></p>
                    <p>Rate: ‚Ç¶50 per vote</p>
                    <p class="price">Total: ‚Ç¶<span id="summaryTotal">50</span></p>
                </div>

                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="closeVoteModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button class="btn btn-success" onclick="processPayment()" id="payNowBtn">
                        <i class="fas fa-credit-card"></i> Pay & Vote Now
                    </button>
                </div>
            </div>
        </div>
 

        <!-- Loading Screen -->
        <div id="loadingScreen" class="loading">
            <div class="loading-content">
                <div class="spinner"></div>
                <p>Processing your vote...</p>
            </div>
        </div>

        <!-- Instructions -->
        <div style="border:1px solid #ddd; padding:15px; border-radius:10px; background-color:#f9f9f9; font-family:Arial, sans-serif; font-size:14px; line-height:1.6; color:#333; margin-top: 30px;">
            <p style="margin:0 0 10px 0; font-weight:bold; font-size:15px;">Voting Instructions:</p>
            <ol style="margin:0; padding-left:20px;">
                <li style="margin-bottom:8px;">Click on any nominee to open the voting modal</li>
                <li style="margin-bottom:8px;">Enter your details and number of votes you want to purchase</li>
                <li style="margin-bottom:8px;">Each vote costs ‚Ç¶50. Payment is processed through Flutterwave</li>
                <li>After successful payment, your votes will be counted automatically</li>
            </ol>
        </div>

        <div class="host-info" style="margin-top: 30px;">
            <strong>Desire Led Administration</strong>
        </div>

        <div class="host-info" style="margin-top: 20px;">
            Hosted by: <strong>35th Administration Anniversary</strong>
        </div>

        <!-- Powered By -->
        <div style="text-align: center; margin-top: 40px; padding: 30px; opacity: 0.8;">
            <img src="https://i.ibb.co/HpBDMgvM/REWARDER-20250901-173722-0000.png"  alt="Rewarder Logo" style="width: 100px; height: auto; margin-bottom: 15px; border-radius: 50%;">
            <p><strong>Powered by Rewarder</strong></p>
        </div>
    </div> <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    
    
<script>
    
    // Firebase SDK Configuration and Initialization
const firebaseConfig = {
    apiKey: "AIzaSyDW8V2SjNITrA4LcdmeILh944mTbOKnM0c",
    authDomain: "rewarderhub.firebaseapp.com",
    projectId: "rewarderhub",
    storageBucket: "rewarderhub.firebasestorage.app",
    messagingSenderId: "85965945106",
    appId: "1:85965945106:web:fa0a57d8968926e1041bcb",
    measurementId: "G-F2ERB5NGN0"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Categories with nominees (Nulass Awards)
const nominationCategories = {
    'staylite_of_year': {
        name: 'Staylite of the Year',
        nominees: [
            { name: 'Bami' },
            { name: 'Rabiu' },
            { name: 'Hassan Yussuff' },
            { name: 'Desire' },
            { name: 'Ojikutu Abdullahi Abdulmal' }
        ]
    },

'socialite_of_year': {
        name: 'Socialite of the Year',
        nominees: [
            { name: 'Bami' },
            { name: 'Calculus Boy' },
            { name: 'Oluhunosebi' },
            { name: 'Lasisi Ayomide' },
            { name: 'Sammy' }
        ]
    },
    'socialite': {
        name: 'Socialite of the Year - Epe Campus ',
        nominees: [
            { name: 'Mulikat' },
            { name: 'ZainyPerk' },
            { name: 'Aizat' },
            { name: 'Bamzzy' },
            { name: 'Tande' },
            { name: 'BFA' },
            { name: 'Rayman' },
            { name: 'Ade' },
            { name: 'Alameen' },
            { name: 'Hon Kenny B' },
            { name: 'Classic' }
        ]
    },

    'rookie': {
        name: 'Rookie of the Year - Epe Campus',
        nominees: [
            { name: 'Dhikr' },
            { name: 'Fatimah Egusi' },
            { name: 'Alu Zainab' },
            { name: 'Zainy Perk' },
            { name: 'Hammed bashorun' },
            { name: 'Ola' },
            { name: 'BFA' },
            { name: 'Syx' },
            { name: 'Abdul Kofoworola' }
        ]
    },

'Rookie_ikeja': {
        name: 'Rookie of the Year - ikeja campus ',
        nominees: [
            { name: 'Adedeji Daniel' },
            
        ]
    },


    'nulassite_of_year': {
        name: 'Nulassite of the Year',
        nominees: [
            { name: 'Olasun Kanmi' },
            { name: 'Olotu Moses' },
            { name: 'Scarface' },
            { name: 'Ojikutu Peace' },
            { name: 'Avosegamu' },
            { name: 'Awonuga' },
            { name: 'Emperor' },
            { name: 'Hon. Muhammed Ishola' },
            { name: 'Sulamon Oyinlakan' },
            { name: 'Onwubadewa Ojikutu' },
            { name: 'Bami' },
            { name: 'Rotimi Cole' },
            { name: 'Peace Onwubadewa' }
        ]
    },

    'executive_ojo': {
    name: 'Executive of the Year - OJO Campus',
    nominees: [
        { name: 'Desire' },
        { name: 'Rofiat' },
        { name: 'Olohunosebi' },
        { name: 'Odu Portrait' },
        { name: 'Habeeb Lamina' },
        { name: 'Emperor' },
        { name: 'Japhar' },
        { name: 'Olamide' },
        { name: 'Moyosore' },
        { name: 'Scarface' },
        { name: 'Hakeem' },
        { name: "Dunedain" }
    ]
},

'executive_ikeja': {
        name: 'Executive of the Year-Ikeja Campus',
        nominees: [
       
            { name: 'Alameen' }
        ]
    },

    'executive': {
        name: 'Executive of the Year',
        nominees: [
            { name: 'Hafsah' },
            { name: 'Bolanle' },
            { name: 'ZainyPerk' },
            { name: 'Bamzzy' },
            { name: 'BFA' },
            { name: 'Adeyeri' },
            { name: 'Alameen' }
        ]
    },

    'parliamentarian_of_year': {
        name: 'Parliamentarian of the Year',
        nominees: [
            { name: 'Scarface' },
            { name: 'Hameed Bashorun' },
            { name: 'Ishola' },
            { name: 'Da Silva' },
            { name: 'Hon. Ayobami' },
            { name: 'Ololunosebi' },
            { name: 'Ogunbiyi Yewande' },
            { name: 'Justice' },
            { name: 'Rashidat Sulamon' },
            { name: 'Olasunkanmi Owoyemi' },
            { name: 'Hussien Onwonlu' },
            { name: 'Hon. Yusuf Olatunji' }
        ]
    },

    'most_supportive': {
        name: 'Most Supportive',
        nominees: [
            { name: 'Rafahhh (Welfare)' },
            { name: 'Owoyemi' },
            { name: 'Sulaimon Oyinlakasola' }
        ]
    },

    'clique_of_year': {
        name: 'Clique of the Year',
        nominees: [
            { name: 'Oluhunosebi' },
            { name: 'Babatunde Rufai' },
            { name: 'Emperor' }
        ]
    },

    'mostExpensive': {
        name: 'Most Expensive - Epe Campus',
        nominees: [
            { name: 'Teddy' },
            { name: 'Classic' },
            { name: 'Tande' },
            { name: 'BFA' },
            { name: 'Bamzzy' },
            { name: 'Azeza' },
            { name: 'Yung' },
               { name: 'Quawiy' },
            { name: 'Abdulazeez Abass' }
        ]
    },

    'humanitarian_male': {
        name: 'Humanitarian of the Year (Male)',
        nominees: [
            { name: 'Emperor' },
            { name: 'Babatunde Rufai' },
            { name: 'Oluhunosebi' },
            { name: 'Ishola' },
            { name: 'Bami' },
            { name: 'BFA' },
            { name: 'Avosegamu Senator' }
        ]
    },

    'humanitarian_female': {
        name: 'Humanitarian of the Year (Female)',
        nominees: [
            { name: 'Avoseganju Serafon' },
            { name: 'Aminat' },
            { name: 'Omowunmi Abibat' },
            { name: 'Alliuzanaiyan' }
        ]
    },

    'humanitarian': {
        name: 'Humanitarian of the Year - Epe Campus',
        nominees: [
            { name: 'BFA' },
            { name: 'Egi' },
            { name: 'Kuti' },
            { name: 'Bamzzy' },
            { name: 'Zainyperk' },
            { name: 'Hon Kenny B' },
            { name: 'Aliu Zainab' }
        ]
    },

'Humanitarian Of the Year (Ikeja Campus)': {
        name: 'Humanitarian Of the Year-Ikeja Campus',
        nominees: [
            { name: 'Shittabey Timilehin Sulaimon ' },
            
        ]
    },

    'most_active_external': {
        name: 'Most Active External Campus',
        nominees: [
            { name: 'Ikeya' },
            { name: 'Epe' },
            { name: 'Ojo' }
        ]
    },

    'finalist': {
        name: 'Finalist of the Year - Epe Campus',
        nominees: [
            { name: 'Maryam' },
            { name: 'Omofo' },
            { name: 'Rabiu Hameedat' },
            { name: 'Azezat' },
            { name: 'Adams' },
            { name: 'Jasmine' },
            { name: 'Adam the first' },
               { name: 'Desire' },
                  { name: 'Rofiat' },
                     { name: 'Aminat' },
                        { name: 'Mulikat' },   { name: 'Rt Hon Hassan' },
            { name: 'Balogun Farouk' }
        ]
    },

'Finalist of the Year (Ikeja Campus)*': {
        name: 'Finalist of the Year-ikeja Campus ',
        nominees: [
            { name: 'Abdulrahman Habeebat' },
           
        ]
    },



    'alumni_of_year': {
        name: 'Alumni of the Year',
        nominees: [
            { name: 'Senator Rahmon Saheed' },
            { name: 'Adenle Sabur' },
            { name: 'Temi Tope' }
        ]
    },

    'couple_of_year': {
        name: 'Couple of the Year',
        nominees: [
            { name: 'Scar Face and Babe' }
        ]
    },

    'program_of_year': {
        name: 'Program of the Year',
        nominees: [
            { name: 'Ibile Week' },
            { name: 'Epe Legislative Confer' },
            { name: 'ELC 4.0' }
        ]
    },

    'most_reserved': {
        name: 'Most Reserved Nulassite',
        nominees: [
            { name: 'Oluhunosebi' },
            { name: 'Omidiji Esther' },
            { name: 'Ishola' },
            { name: 'Olasunkanmi' },
            { name: 'Omowunmi' }
        ]
    },

    'most_popular': {
        name: 'Most Popular Nulassite',
        nominees: [
            { name: 'Scar Face' },
            { name: 'Oluhunosebi' },
            { name: 'Abass Mulikat' },
            { name: 'Desire' },
            { name: 'Emperor' },
            { name: 'Hon Kenny B' },
            { name: 'Akachukwu Ezekiel' }
        ]
    },

    'mostPopular': {
        name: 'Most Popular Student-Epe Campus',
        nominees: [
            { name: 'Mulikat' },
            { name: 'Azezat' },
            { name: 'T and C' },
            { name: 'BFG' },
            { name: 'Bamzzy' },
            { name: 'Zainy Perk' }
        ]
    },

    'scholar': {
        name: 'Scholar of the Year - Epe Campus',
        nominees: [
            { name: 'Openipo' },
            { name: 'Classic' },
            { name: 'Zainy Rock' },
            { name: 'Bamzzy' },
            { name: 'Alu Zainab' },
            { name: 'Oloade' },
            { name: 'BFA' }
        ]
    },

      'brand_of_year': {
        name: 'Brand of the Year',
        nominees: [
            { name: 'Ay Chops' },
            { name: 'Rewarder (Ismart DC)' },
            { name: 'Olatunwa Shawarma' },
            { name: 'Accessories with Aminah' },
            { name: 'Faithie Nails' }
        ]
    },

    'entrepreneur_of_year': {
        name: 'Entrepreneur of the Year',
        nominees: [
            { name: 'Imary Cakes' },
            { name: 'Bashorun Idris (Rewarder - Ismart)' },
            { name: 'Sir Babatunde Senator Materials' }
        ]
    },

    'most_talented': {
        name: 'Most Talented Nulassite',
        nominees: [
            { name: 'Phleomzy' },
            { name: 'Roferat' },
            { name: 'Olokunosebi' },
            { name: 'Calculus Boy' },
            { name: 'Akachukwu Ezekiel' },
            { name: 'Bami' },
            { name: 'Overyomi' }
        ]
    },

    'content_creator': {
        name: 'Content Creator of the Year',
        nominees: [
            { name: 'Aanu Adeniyi' },
            { name: 'Oluwagbenga' },
            { name: 'Phleomzy' }
        ]
    },

    'division_president': {
        name: 'Division President of the Year',
        nominees: [
            { name: 'Yussuff Ibraheem' },
            { name: 'Crownstar' },
            { name: 'Balogun Aminat' },
            { name: 'Lanre' },
            { name: 'Justice' },
            { name: 'Olowolayewo' },
            { name: 'Desire' },
            { name: 'BFA' }
        ]
    },

    'division_speaker': {
        name: 'Division Speaker of the Year',
        nominees: [
            { name: 'Maryam Rabi' },
            { name: 'Zulaykan' },
            { name: 'Ogunbiyi Hafsah' },
            { name: 'Akorede' }
        ]
    },

    'political_icon_main': {
        name: 'Political Icon',
        nominees: [
            { name: 'Paramole' },
            { name: 'Oluhunosebi' },
            { name: 'Anjorin Desire' },
            { name: 'Ogunbiyi Hafsah' },
            { name: 'Hon. Hassan Yusuf Olatunji' },
            { name: 'Emperor' },
            { name: 'Hon. Muhammed Ishola' }
        ]
    },

    'political_icon_epe': {
        name: 'Political Icon - Epe Campus',
        nominees: [
            { name: 'Mulikat' },
            { name: 'Nani' },
            { name: 'ZainyPerk' },
            { name: 'Aizat' },
            { name: 'Bamzzy' },
            { name: 'Balogun' },
            { name: 'BFA' },
            { name: 'Rabiuhan' },
            { name: 'Farouq Balogun' }
        ]
    },
    
    'political_icon_ikeja': {
        name: 'Political Icon - Ikeja Campus',
        nominees: [
            { name: 'Lawson Michael Olaiya ' },
            
        ]
    },
    
    'fresher_male': {
        name: 'Fresher of the Year (Male)',
        nominees: [
            { name: 'Khalifa' },
            { name: 'Oladimeji' },
            { name: 'Sharwama' },
            { name: 'Babatunde Rufai' },
            { name: 'Akachukwu Ezekiel' },
            { name: 'Matto' },
            { name: 'Ags Nukass' }
        ]
    },

    
    'fresher_female': {
        name: 'Fresher of the Year (Female)',
        nominees: [
            { name: 'Reece Ojikutu' },
            { name: 'Nwuko Sharon' },
            { name: 'Oyindamola' },
            { name: 'Aifamog' }
        ]
    },

    'sportsman_male': {
        name: 'Sportsman of the Year (Male)',
        nominees: [
            { name: 'Olabunkanmi Awoyemi' },
            { name: 'Hakeem' },
            { name: 'Balo' },
            { name: 'Jago' },
            { name: 'Oluhunosebi' },
            { name: 'Solo of Lasu' }
        ]
    },

    'sportsman_female': {
        name: 'Sportsman of the Year (Female)',
        nominees: [
            { name: 'Victoria (Vhee)' },
            { name: 'Kaybee' },
            { name: 'Ajuwaga Oluwa Tubisiba' },
            { name: 'Smiles' },
            { name: 'Rabiu Maryam' }
        ]
    },

    'sportsman': {
        name: 'Sportsman of the Year - Epe Campus',
        nominees: [
            { name: 'Bolarinwa' },
            { name: 'Tunde' },
            { name: 'Classic' },
            { name: 'Zainyperk' },
            { name: 'Lynx' },
            { name: 'Ilias' },
            { name: 'Emmanuel' },
            { name: 'BFA' },
            { name: 'Azezat' }
        ]
    },

    'most_beautiful': {
        name: 'Most Beautiful',
        nominees: [
            { name: 'Nimat' },
            { name: 'Omowunmi' },
            { name: 'Oyindamola' },
            { name: 'Mbadwe Chiamaka' },
            { name: 'Khamat Desire' }
        ]
    },

    'friend_of_union': {
        name: 'Friend of the Union',
        nominees: [
            { name: 'Babatunde Rufai' },
            { name: 'Oluhunosebi' },
            { name: 'Badmus Aminat' }
        ]
    },

    'staff_adviser': {
        name: 'Staff Adviser of the Year',
        nominees: [
            { name: 'Dr. Idawu Awoyemi' },
            { name: 'Mr Wale Anthony' },
            { name: 'Prof. Sanni Habeeb.' },
            { name: 'Abatan' }
        ]
    },

    'most_active_division': {
        name: 'Most Active Division',
        nominees: [
            { name: 'Ikorodu' },
            { name: 'Badagry' },
            { name: 'Ikeja Division' },
            { name: 'Epe' },
            { name: 'Lagos Division' }
        ]
    }
};


 // Scroll to Top Functionality
        function initScrollToTop() {
            const scrollUpBtn = document.getElementById('scrollToTop');
            const scrollDownBtn = document.getElementById('scrollDown');
            
            window.addEventListener('scroll', function() {
                const scrollPosition = window.pageYOffset;
                const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
                
                // Show scroll up button after scrolling 300px
                if (scrollPosition > 300) {
                    scrollUpBtn.classList.add('show');
                } else {
                    scrollUpBtn.classList.remove('show');
                }
                
                // Hide scroll down button if at bottom
                if (scrollPosition >= documentHeight - 100) {
                    scrollDownBtn.style.display = 'none';
                } else {
                    scrollDownBtn.style.display = 'block';
                }
            });
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function scrollDown() {
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth'
            });
        }
        
// Global Variables
let selectedNominee = null;
let selectedCategory = null;
let currentVoteCount = 1;

// Flutterwave Configuration - Replace with your production key
const FLUTTERWAVE_PUBLIC_KEY = 'FLWPUBK-d3902fdb2f80f41ada9c077eb569466a-X';

document.addEventListener('DOMContentLoaded', function() {
    renderCategories();
    setupEventListeners();
    loadVoteCounts();
    
});

function setupEventListeners() {
    document.getElementById('voteCount').addEventListener('input', updateVoteSummary);
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') closeVoteModal();
    });
}


// Toggle category list dropdown
document.getElementById("categoryMenuBtn").addEventListener("click", () => {
    const dropdown = document.getElementById("categoryDropdown");
    dropdown.style.display = dropdown.style.display === "flex" ? "none" : "flex";
});

// Populate category dropdown
function renderCategoryDropdown() {
    const dropdown = document.getElementById("categoryDropdown");
    dropdown.innerHTML = '';
    Object.entries(nominationCategories).forEach(([id, data]) => {
        const btn = document.createElement("button");
        btn.textContent = data.name;
        btn.onclick = () => {
            document.getElementById(`card-${id}`).scrollIntoView({ behavior: "smooth" });
            dropdown.style.display = "none";
        };
        dropdown.appendChild(btn);
    });
}

function renderCategories() {
    const grid = document.getElementById('categoriesGrid');
    grid.innerHTML = '';

    Object.entries(nominationCategories).forEach(([categoryId, categoryData]) => {
        const categoryCard = document.createElement('div');
        categoryCard.className = 'category-card';
        categoryCard.id = `card-${categoryId}`;

        // Remove vote count display
        const nomineesHtml = categoryData.nominees.map((nominee, index) => `
            <div class="nominee-item" onclick="openVoteModal('${categoryId}', ${index})">
                <div class="nominee-info">
                    <div class="nominee-name">${nominee.name}</div>
                </div>
            </div>
        `).join('');

        categoryCard.innerHTML = `
            <div class="category-title" onclick="toggleCategory('${categoryId}')">
                ${categoryData.name}
            </div>
            <div class="nominees-list" id="nominees-${categoryId}">
                ${nomineesHtml}
            </div>
        `;

        grid.appendChild(categoryCard);
    });

    renderCategoryDropdown();
}
        

// Modal Functions
function openVoteModal(categoryId, nomineeIndex) {
    selectedCategory = categoryId;
    selectedNominee = nomineeIndex;
    
    const nominee = nominationCategories[categoryId].nominees[nomineeIndex];
    const category = nominationCategories[categoryId];
    
    document.getElementById('modalNomineeInfo').innerHTML = `
        <h4><i class="fas fa-user"></i> ${nominee.name}</h4>
        <p><strong>Category:</strong> ${category.name}</p>
        
    `;
    
    document.getElementById('voterName').value = '';
    document.getElementById('voterEmail').value = '';
    document.getElementById('voteCount').value = 1;
    updateVoteSummary();
    
    document.getElementById('voteModal').style.display = 'block';
    setTimeout(() => document.getElementById('voterName').focus(), 100);
}

function closeVoteModal() {
    document.getElementById('voteModal').style.display = 'none';
    selectedNominee = null;
    selectedCategory = null;
}


function processPayment() {
    if (!validateForm()) return;

    const voterName = document.getElementById('voterName').value.trim();
    const voterEmail = document.getElementById('voterEmail').value.trim();
    const voteCount = parseInt(document.getElementById('voteCount').value) || 1;
    
    const nominee = nominationCategories[selectedCategory].nominees[selectedNominee];
    const category = nominationCategories[selectedCategory];
    const amount = voteCount * 50;
    const txRef = 'nulass_vote_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    
    const voteData = {
        voterName,
        voterEmail, 
        nominee: nominee.name,
        category: category.name,
        categoryId: selectedCategory,
        nomineeIndex: selectedNominee,
        voteCount,
        amount,
        txRef
    };
    
    togglePayButton(true);
    
    FlutterwaveCheckout({
        public_key: 'FLWPUBK-d3902fdb2f80f41ada9c077eb569466a-X',
        tx_ref: txRef,
        amount: amount,
        currency: "NGN",
        country: "NG",
        payment_options: "card,ussd,banktransfer,mobilemoney",
        customer: {
            email: voterEmail,
            name: voterName,
        },
        customizations: {
            title: "Nulass Awards Voting",
            description: `Vote for ${nominee.name} in ${category.name}`,
            logo: "https://i.ibb.co/zWr7G0xB/IMG-20250819-WA0055-1.jpg",
        },
        callback: (response) => {
            if (response.status === "successful" || response.status === "completed" || response.tx_ref) {
                processVoteAfterPayment(response, voteData)
                    .then(() => {
                        showAlert(`Successfully voted ${voteCount} time(s) for ${nominee.name}! Thank you for participating.`, 'success');
                        closeVoteModal();
                        setTimeout(() => loadVoteCounts(), 2000);
                    })
                    .catch(error => {
                        showAlert('Payment successful but error saving vote. Contact support with transaction ID: ' + (response.transaction_id || response.tx_ref), 'warning');
                    });
            } else if (response.status === "cancelled") {
                showAlert('Payment was cancelled.', 'info');
            } else {
                showAlert('Payment failed. Please try again.', 'error');
            }
            togglePayButton(false);
        },
        onclose: () => {
            togglePayButton(false);
        }
    });
}

async function processVoteAfterPayment(paymentResponse, voteData) {
    try {
        showLoading(true);
        
        const voteRecord = {
            voterName: voteData.voterName,
            voterEmail: voteData.voterEmail,
            nominee: voteData.nominee,
            category: voteData.category,
            categoryId: voteData.categoryId,
            nomineeIndex: voteData.nomineeIndex,
            voteCount: voteData.voteCount,
            paymentAmount: voteData.amount,
            transactionRef: voteData.txRef,
            flutterwaveRef: paymentResponse.transaction_id || paymentResponse.flw_ref,
            paymentStatus: paymentResponse.status,
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
            createdAt: new Date().toISOString()
        };

        const docRef = await db.collection('nulass_voting').add(voteRecord);
        
        const nominee = nominationCategories[voteData.categoryId].nominees[voteData.nomineeIndex];
        nominee.votes = (nominee.votes || 0) + voteData.voteCount;
        
        updateVoteDisplay(voteData.categoryId, voteData.nomineeIndex);
        
        return docRef;
        
    } catch (error) {
        console.error('Error saving vote:', error);
        throw error;
    } finally {
        showLoading(false);
    }
}


// Fixed Firebase Save Operation
async function saveVoteToFirebase(paymentResponse, voteData) {
    console.log('Attempting to save vote to Firebase...');
    console.log('Vote data:', voteData);
    console.log('Payment response:', paymentResponse);
    
    try {
        showLoading(true);
        
        // Create the vote record with proper structure
        const voteRecord = {
            // Voter information
            voterName: voteData.voterName,
            voterEmail: voteData.voterEmail,
            
            // Vote details
            nominee: voteData.nominee,
            category: voteData.category,
            categoryId: voteData.categoryId,
            nomineeIndex: voteData.nomineeIndex,
            voteCount: voteData.voteCount,
            
            // Payment information
            paymentAmount: voteData.amount,
            transactionRef: voteData.txRef,
            flutterwaveRef: paymentResponse.transaction_id || paymentResponse.flw_ref,
            paymentStatus: paymentResponse.status,
            
            // Additional payment details
            paymentData: {
                amount: paymentResponse.amount,
                currency: paymentResponse.currency || 'NGN',
                charged_amount: paymentResponse.charged_amount,
                processor_response: paymentResponse.processor_response
            },
            
            // Timestamp
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
            createdAt: new Date().toISOString()
        };

        console.log('Saving vote record:', voteRecord);
        
        // Save to Firebase
        const docRef = await db.collection('nulass_voting').add(voteRecord);
        console.log('Vote saved successfully with ID:', docRef.id);
        
        // Update local vote count
        const nominee = nominationCategories[voteData.categoryId].nominees[voteData.nomineeIndex];
        nominee.votes = (nominee.votes || 0) + voteData.voteCount;
        
        console.log('Updated local vote count for', voteData.nominee, 'to', nominee.votes);
        
        // Update UI
        updateVoteDisplay(voteData.categoryId, voteData.nomineeIndex);
        closeVoteModal();
        
        showAlert(`Successfully voted ${voteData.voteCount} time(s) for ${voteData.nominee}! Thank you for participating.`, 'success');
        
        // Optional: Refresh vote counts from server
        setTimeout(() => {
            loadVoteCounts();
        }, 2000);
        
    } catch (error) {
        console.error('Error saving vote to Firebase:', error);
        console.error('Error details:', error.message, error.code);
        
        // Try to save a minimal record in case of partial failure
        try {
            const minimalRecord = {
                voter: voteData.voterName,
                email: voteData.voterEmail,
                nominee: voteData.nominee,
                category: voteData.category,
                votes: voteData.voteCount,
                amount: voteData.amount,
                txRef: voteData.txRef,
                flwRef: paymentResponse.transaction_id || paymentResponse.flw_ref,
                status: 'payment_successful_save_error',
                timestamp: new Date().toISOString(),
                error: error.message
            };
            
            await db.collection('nulass_voting_backup').add(minimalRecord);
            console.log('Saved to backup collection');
            
        } catch (backupError) {
            console.error('Backup save also failed:', backupError);
        }
        
        showAlert('Vote recorded but there was an issue saving details. Please contact support with your transaction reference: ' + voteData.txRef, 'warning');
    } finally {
        showLoading(false);
        togglePayButton(false);
    }
}



// Improved Error Handling for Form Validation
function validateForm() {
    const voterName = document.getElementById('voterName').value.trim();
    const voterEmail = document.getElementById('voterEmail').value.trim();
    const voteCount = parseInt(document.getElementById('voteCount').value) || 0;

    if (!voterName) {
        showAlert('Please enter your name', 'error');
        return false;
    }

    if (!voterEmail || !isValidEmail(voterEmail)) {
        showAlert('Please enter a valid email address', 'error');
        return false;
    }

    if (voteCount < 1) {
        showAlert('Please enter at least 1 vote', 'error');
        return false;
    }

    if (voteCount > 9000) {
        showAlert('Maximum 10000 votes allowed per transaction', 'error');
        return false;
    }

    return true;
}

// Helper Functions
function togglePayButton(disabled) {
    const payButton = document.getElementById('payNowBtn');
    payButton.disabled = disabled;
    payButton.innerHTML = disabled ? 
        '<i class="fas fa-spinner fa-spin"></i> Processing...' : 
        '<i class="fas fa-credit-card"></i> Pay & Vote Now';
}


// Enhanced Alert System
function showAlert(message, type) {
    console.log('Showing alert:', type, message);
    
    // Remove any existing alerts
    document.querySelectorAll('.alert').forEach(alert => alert.remove());
    
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type}`;
    alertDiv.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 10000;
        padding: 15px 20px;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        max-width: 400px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        ${type === 'success' ? 'background: linear-gradient(135deg, #4CAF50, #45a049);' : ''}
        ${type === 'error' ? 'background: linear-gradient(135deg, #f44336, #d32f2f);' : ''}
        ${type === 'warning' ? 'background: linear-gradient(135deg, #ff9800, #f57c00);' : ''}
    `;
    
    alertDiv.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'exclamation-triangle'}"></i>
        ${message}
    `;
    
    document.body.appendChild(alertDiv);
    
    // Auto remove after 8 seconds
    setTimeout(() => {
        if (alertDiv.parentNode) {
            alertDiv.remove();
        }
    }, 8000);
    
    // Make it clickable to dismiss
    alertDiv.addEventListener('click', () => alertDiv.remove());
}




// Enhanced Loading Screen
function showLoading(show) {
    let loadingScreen = document.getElementById('loadingScreen');
    
    if (show && !loadingScreen) {
        loadingScreen = document.createElement('div');
        loadingScreen.id = 'loadingScreen';
        loadingScreen.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        `;
        loadingScreen.innerHTML = `
            <div style="
                background: white;
                padding: 30px;
                border-radius: 15px;
                text-align: center;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            ">
                <div style="
                    width: 40px;
                    height: 40px;
                    border: 4px solid #f3f3f3;
                    border-top: 4px solid #B7410E;
                    border-radius: 50%;
                    animation: spin 1s linear infinite;
                    margin: 0 auto 15px;
                "></div>
                <p style="margin: 0; font-weight: 500; color: #333;">Processing your vote...</p>
            </div>
            <style>
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
            </style>
        `;
        document.body.appendChild(loadingScreen);
    }
    
    if (loadingScreen) {
        loadingScreen.style.display = show ? 'flex' : 'none';
        if (!show && loadingScreen.parentNode) {
            setTimeout(() => loadingScreen.remove(), 300);
        }
    }
}


// Improved Vote Count Loading
async function loadVoteCounts() {
    console.log('Loading vote counts from Firebase...');
    
    try {
        const snapshot = await db.collection('nulass_voting').get();
        console.log('Loaded', snapshot.size, 'vote records');
        
        // Reset all vote counts
        Object.keys(nominationCategories).forEach(categoryId => {
            nominationCategories[categoryId].nominees.forEach(nominee => {
                nominee.votes = 0;
            });
        });
        
        // Update votes from Firebase
        let totalVotes = 0;
        snapshot.forEach(doc => {
            const data = doc.data();
            console.log('Processing vote record:', data);
            
            const categoryId = data.categoryId;
            const nomineeIndex = data.nomineeIndex;
            const voteCount = data.voteCount || 1;
            
            if (nominationCategories[categoryId] && 
                nominationCategories[categoryId].nominees[nomineeIndex]) {
                
                nominationCategories[categoryId].nominees[nomineeIndex].votes = 
                    (nominationCategories[categoryId].nominees[nomineeIndex].votes || 0) + voteCount;
                
                totalVotes += voteCount;
            } else {
                console.warn('Invalid category or nominee index:', categoryId, nomineeIndex);
            }
        });
        
        console.log('Total votes loaded:', totalVotes);
        
        // Update UI for all nominees
        Object.keys(nominationCategories).forEach(categoryId => {
            nominationCategories[categoryId].nominees.forEach((_, index) => {
                updateVoteDisplay(categoryId, index);
            });
        });
        
    } catch (error) {
        console.error('Error loading vote counts:', error);
        showAlert('Failed to load current vote counts. Please refresh the page.', 'error');
    }
}



// Enhanced Vote Display Update
function updateVoteDisplay(categoryId, nomineeIndex) {
    const nominee = nominationCategories[categoryId].nominees[nomineeIndex];
    const votes = nominee.votes || 0;
    
    // Update vote count display if element exists
    const voteElement = document.getElementById(`votes-${categoryId}-${nomineeIndex}`);
    if (voteElement) {
        voteElement.textContent = `${votes} vote${votes !== 1 ? 's' : ''}`;
    }
    
    // Update any vote bars or progress indicators if they exist
    const voteBar = document.getElementById(`votebar-${categoryId}-${nomineeIndex}`);
    if (voteBar && votes > 0) {
        // Calculate percentage within category
        const categoryVotes = nominationCategories[categoryId].nominees.reduce((sum, n) => sum + (n.votes || 0), 0);
        const percentage = categoryVotes > 0 ? (votes / categoryVotes) * 100 : 0;
        voteBar.style.width = `${percentage}%`;
    }
}


function updateVoteSummary() {
    const voteCount = parseInt(document.getElementById('voteCount').value) || 1;
    const total = voteCount * 50;
    document.getElementById('summaryVotes').textContent = voteCount;
    document.getElementById('summaryTotal').textContent = total;
    currentVoteCount = voteCount;
}

function togglePayButton(disabled) {
    const payButton = document.getElementById('payNowBtn');
    payButton.disabled = disabled;
    payButton.innerHTML = disabled ? 
        '<i class="fas fa-spinner fa-spin"></i> Processing...' : 
        '<i class="fas fa-credit-card"></i> Pay & Vote Now';
}

function isValidEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}


// Event Listeners
window.onclick = function(event) {
    if (event.target === document.getElementById('voteModal')) {
        closeVoteModal();
    }
};

// Auto-refresh votes
setInterval(loadVoteCounts, 30000);

/* ---------------------------
   Category toggle function
   --------------------------- */
function toggleCategory(categoryId) {
    const list = document.getElementById(`nominees-${categoryId}`);
    if (!list) return;
    const isOpen = list.classList.contains('open');

    // close other open lists (optional)
    document.querySelectorAll('.nominees-list.open').forEach(l => {
        if (l !== list) l.classList.remove('open');
    });

    if (!isOpen) {
        list.classList.add('open');
        // ensure card is visible
        const card = document.getElementById(`card-${categoryId}`);
        if (card) card.scrollIntoView({ behavior: 'smooth', block: 'center' });
    } else {
        list.classList.remove('open');
    }
}






/* ---------------------------
   Live search setup
   --------------------------- */
function setupSearch() {
    const searchBar = document.getElementById('searchBar');
    if (!searchBar) {
        console.warn('setupSearch: No element with id="searchBar" found.');
        return;
    }

    // Wrap the searchBar in .search-wrapper if not already wrapped
    let wrapper = searchBar.parentElement;
    if (!wrapper.classList || !wrapper.classList.contains('search-wrapper')) {
        const newWrap = document.createElement('div');
        newWrap.className = 'search-wrapper';
        wrapper.insertBefore(newWrap, searchBar);
        newWrap.appendChild(searchBar);
        wrapper = newWrap;
    }

    // Create results container if it doesn't exist
    let results = document.getElementById('searchResults');
    if (!results) {
        results = document.createElement('div');
        results.id = 'searchResults';
        results.className = 'search-results';
        wrapper.appendChild(results);
    }

    // Inject minimal styles for the results panel (optional: move into your CSS)
    if (!document.getElementById('searchResultsStyles')) {
        const style = document.createElement('style');
        style.id = 'searchResultsStyles';
        style.textContent = `
            .search-wrapper { display:flex; gap:18px; align-items:flex-start; position:relative; }
            #searchBar { flex:1; min-width:260px; }
            .search-results {
                width:360px;
                max-height:420px;
                overflow:auto;
                background:#fff;
                border-radius:12px;
                box-shadow:0 10px 30px rgba(0,0,0,0.12);
                padding:8px;
                display:none;
                z-index:1100;
                border:1px solid rgba(0,0,0,0.06);
            }
            .search-results .result-group { margin-bottom:10px; }
            .search-results .result-group h4 { font-size:0.95rem; margin:6px 6px; color:#333; }
            .search-results .result { padding:8px 10px; border-radius:8px; cursor:pointer; display:flex; justify-content:space-between; gap:8px; align-items:center; }
            .search-results .result:hover { background: linear-gradient(90deg, rgba(183,65,14,0.06), rgba(74,144,226,0.02)); }
            .search-results mark { background:#fff1c8; padding:0 3px; border-radius:3px; color:#B7410E; font-weight:700; }
            .search-results .meta { opacity:0.6; font-size:0.85rem; }
            .search-results .no-results { padding:12px; color:#666; }
        `;
        document.head.appendChild(style);
    }

    // helper to escape regex and highlight matches
    const escapeForRegex = s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    const highlight = (text, q) => {
        if (!q) return text;
        const rx = new RegExp(`(${escapeForRegex(q)})`, 'ig');
        return text.replace(rx, '<mark>$1</mark>');
    };

    // Input handler
    searchBar.addEventListener('input', (e) => {
        const raw = e.target.value;
        const q = raw.trim();
        if (!q) {
            // hide results and show all cards
            results.style.display = 'none';
            document.querySelectorAll('.category-card').forEach(c => c.style.display = '');
            return;
        }
        const query = q.toLowerCase();

        // Collect matches
        const matches = []; // { type:'category'|'nominee', catId, name, idx?, catName? }
        Object.entries(nominationCategories).forEach(([catId, cat]) => {
            if (cat.name.toLowerCase().includes(query)) {
                matches.push({ type: 'category', catId, name: cat.name });
            }
            cat.nominees.forEach((n, idx) => {
                if (n.name.toLowerCase().includes(query)) {
                    matches.push({ type: 'nominee', catId, catName: cat.name, name: n.name, idx });
                }
            });
        });

        // Update visible cards: show only categories that contain matches
        document.querySelectorAll('.category-card').forEach(card => {
            const id = card.id.replace(/^card-/, '');
            const has = matches.some(m => m.catId === id);
            card.style.display = has ? '' : 'none';
        });

        // Render results panel
        if (matches.length === 0) {
            results.innerHTML = `<div class="no-results">No matches for "<strong>${q}</strong>"</div>`;
            results.style.display = 'block';
            return;
        }

        // Group matches by category
        const grouped = {};
        matches.forEach(m => {
            grouped[m.catId] = grouped[m.catId] || { catName: nominationCategories[m.catId].name, items: [] };
            grouped[m.catId].items.push(m);
        });

        let html = '';
        Object.keys(grouped).forEach(catId => {
            const group = grouped[catId];
            html += `<div class="result-group"><h4>${highlight(group.catName, q)}</h4>`;
            // show unique nominee items + category label
            const itemsShown = [];
            group.items.forEach(item => {
                // avoid duplicates (e.g. category match + nominee match)
                if (item.type === 'category') {
                    html += `<div class="result" data-type="cat" data-cat="${catId}">${highlight(item.name, q)} <span class="meta">Category</span></div>`;
                } else {
                    const key = `${item.name}-${item.idx}`;
                    if (!itemsShown.includes(key)) {
                        itemsShown.push(key);
                        html += `<div class="result" data-type="nom" data-cat="${catId}" data-idx="${item.idx}">${highlight(item.name, q)} <span class="meta">${item.catName}</span></div>`;
                    }
                }
            });
            html += `</div>`;
        });

        results.innerHTML = html;
        results.style.display = 'block';
    });

    // Click handler inside results panel
    results.addEventListener('click', (ev) => {
        const target = ev.target.closest('.result');
        if (!target) return;
        const type = target.dataset.type;
        const cat = target.dataset.cat;
        if (type === 'cat') {
            // scroll to category and open it
            const card = document.getElementById(`card-${cat}`);
            if (card) {
                toggleCategory(cat);
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        } else {
            const idx = Number(target.dataset.idx);
            if (!isNaN(idx)) {
                openVoteModal(cat, idx);
            }
        }
        // clear search and hide
        (document.getElementById('searchBar') || {}).value = '';
        results.style.display = 'none';
        // restore cards visibility
        document.querySelectorAll('.category-card').forEach(c => c.style.display = '');
    });

    // hide panel when clicking outside
    document.addEventListener('click', (e) => {
        if (!wrapper.contains(e.target)) {
            results.style.display = 'none';
        }
    });
}

/* ---------------------------
   Make sure setupSearch is called
   --------------------------- */
document.addEventListener('DOMContentLoaded', function () {
    // If your DOMContentLoaded already calls these, just add setupSearch() into it.
    // I add a safe check so duplicates won't break things:
    if (typeof renderCategories === 'function') {
        // renderCategories(); // <-- keep only if you do not already call it earlier
    }
    if (typeof setupSearch === 'function') setupSearch();
});


document.addEventListener("DOMContentLoaded", () => {
  const ticketBtn = document.getElementById("getTicketBtn");
  if (ticketBtn) {
    ticketBtn.addEventListener("click", () => {
      window.location.href = "ticket.html"; // Redirect to ticket page
    });
  }
});
</script>


   </body>
</html>

